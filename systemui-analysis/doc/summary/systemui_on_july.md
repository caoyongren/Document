# Systemui功能需求与设计实现文档
内容：

- 项目简介
- 功能需求
- 存在问题
- 项目进展
- 设计实现

# 项目简介

本项目属于openthos项目的一部分，提供 [Openthos](https://github.com/openthos/openthos/wiki) 对原SystemUI状态栏系统信息显示位置重定制，以及对现有的功能扩展，并且追加新的功能开始菜单，和常用软件。11月的工作是提高性能和fix bug.

##　当前开发人员 (20161101-20161130)
董鹏 卢宁 曹永韧 刘晓旭

##　当前开发人员 (20160801-20161031)
董鹏 卢宁 曹永韧 王利峰

## 功能需求

|完成|描述|模块|完成度|
|---|---|---|---|
|√| 开始菜单常用软件|界面|100%|
|√| 开始菜单app|界面|100%|
|√| 开始菜单电源|界面|95%|
|√| 开始菜单app分类|界面|90%|
|√| 状态栏时间|界面|100%|
|√| 状态栏常用软件|界面|100%|
|12号| 状态栏通知栏重置|界面|0%|
|x| 状态栏输入法扩展|界面|0%|
|√| 状态栏WIFI扩展|界面|100%|
|√| 状态栏声音扩展|界面|100%|
|√| 开始菜单常用软件|功能|80%|
|√| 开始菜单展示全部app |功能|100%|
|√| 开始菜单搜索|功能|100%|
|√| 开始菜单三种排序：使用频率，安装时间，名称排序|功能|100%|
|√| 开始菜单左边常用软件鼠标右键取消|功能|0%|
|√| 开始菜单右边app鼠标右键可运行可卸载|功能|0%|
|√| 开始菜单电源：关机 重启 锁平 睡眠|功能|90%|
|√| 开始菜单我的电脑 设置|功能|100%|
|√| 状态栏常用软件|功能|100%|
|√| 状态栏时间|功能|100%|
|√| 状态栏home|功能|100%|
|√| 状态栏声音|功能|100%|
|x| 状态栏通知栏|功能|0%|
|x| 状态栏输入法|功能|0%|
|√| 状态栏WIFI|功能|100%|
|x| 状态栏电量|功能|0%|


# 存在问题

| 简述 | 类别 | 备注
|---|---|---|
|调用系统锁屏功能在同方笔记本T43u 和同方台式机精锐x700无效（待调研）|bug|https://dev.openthos.org/zentao/zentao/bug-view-182.html|
|开始菜单点击电源弹出的dialog无法覆盖全屏(同多窗口有关待调研)|bug|https://dev.openthos.org/zentao/zentao/bug-view-194.html|
|Systemui 状态栏中源WIFI逻辑比较复杂需要调研|bug|https://dev.openthos.org/zentao/zentao/bug-view-100.html|
|Systemui与DocumentsUI 需要进行跨项目数据交互 并变更DocumentsUI数据库的内容 功能难度系数高比较耗时|bug|https://dev.openthos.org/zentao/zentao/bug-view-56.html|
|重置Systemui通知栏|功能|功能优先级未开始，需要底层人员协助|
|扩展Systemui 输入法|功能|功能优先级未开始|
|扩展Systemui 电量|功能|功能优先级未开始|

#8月需求
- 1.开始菜单字体支持中文英文
- 2.开始菜单页面图片修改
- 3.开始菜单布局修改
- 4.开始菜单电源功能布局 图片修改
- 5.状态栏左边常用软件图片修改
- 6.状态栏右边系统7个信息（通知栏，电量，输入法，wifi，时间 ，声音，home键）图片修改
- 7.开始菜单右边鼠标右键可卸载可运行功能
- 8.开始菜单左边鼠标右键可取消功能
- 9.状态栏 电量 输入法 功能实现

#8月份任务计划
| 时间节点 | 任务 
|---|---|
|2016/08/01-2016-/08/07 |1 .开始菜单字体支持中文英文 <br />2.实现鼠标右键功能|
|2016/08/08-2016-/08/14 |1 开始菜单页面图片修改。 <br />2开始菜单页面图片修改 <br />3 开始菜单布局修改 <br />4 开始菜单电源功能布局 图片修改<br /> 5 状态栏左边常用软件图片修改 <br />6 状态栏右边系统<br />7个信息（通知栏，电量，输入法，wifi，时间 ，声音，home键）图片修改|
|2016/08/15-2016-/08/21 | 1 开始菜单右边鼠标右键可卸载可运行功能<br /> 2 开始菜单左边鼠标右键可取消功能| 
|2016/08/22-2016-/08/26 |一. 图片替换 <br />1.电源,设置,文件管理器 图标大<br /> 2.菜单选项上三角不明显,需重新提供<br />3.鼠标滑过及点击效果,图片一天切换.<br />4.底部任务栏鼠标事件未替换成效果图<br />5.Startmenu-电源 背景黑色太浅 ;home加一个白线 ;<br />6.输入法 ，电量 ，wifi， 声音，时间<br />7.多窗口三个图标： 关闭 最大化 隐藏<br />二. 布局修改 <br />  1 .左侧(常用软件)与右侧(app列表)比例不对,需修改<br /> 2 wifi 和声音 布局 调整 修改背影<br /> 3.-周一确认返回按钮,及位置<br /> 4.startmenu点击效果位置偏移<br />三. 现有功能扩展 <br /> 1.以手机模式运行<br />2.以桌面模式运行<br />  3.从此列表中移除<br />4.分类排序，升序降序<br />5.电源<br /> 6.输入法<br />|
# 项目进展

- 2016/03/21-2016/04/15
  * 董鹏
    * 熟悉Systemui/../starsbar/PhoneStarsbar.java中函数之间的调用关系
    * 在本地实现开始菜单页面原型。 
    * 同 陈工 谢工 冯杰 讨论项目页面开发的切入口。

- 2016/04/16-2016/04/30
  * 董鹏
      * 在mutilwindows实现Systemui状态栏位置的重置。* 在本地实现开始菜单展示所有app的功能
  * 陈刚   
      * 在陈工的带领下把追加的开始菜单模型及其功能第一次集成到mutilwindows中* 使其页面有了初步的可视效果。
- 2016/05/01-2016/05/15
  * 董鹏
    * 完善了开始菜单展示所有app的功能。
    * 添加我的电脑，设置， 电源（关机，重启，睡眠，锁定，搜索，app分类，常用软件的原型页面 。

- 2016/05/16-2016/05/31
  * 董鹏
    * 实现的function 有我的电脑，设置，电源中的关机，重启，和锁定。

- 2016/06/01-2016/06/15
  * 董鹏
    * 实现开始菜单搜索 ，名称排序，使用频率排序

- 2016/06/16-2016-/06/30
  * 董鹏
    * 实现开始菜单时间排序。左边常用软件
    * 添加Systemui 状态栏中： 通知栏 ，电量，声音，wifi,时间 ，home 页面原型及接口。
  * 余明凯
    * 实现Systemui 状态栏home键功能。

- 2016/07/01-2016-/07/15
  * 董鹏
    * 根据优先级解决|bug|https://dev.openthos.org/zentao/zentao/bug-view-39.html|
    * 根据优先级解决|bug|https://dev.openthos.org/zentao/zentao/bug-view-82.html|
    * 实现Systemui状态栏 时间功能
  * 余明凯
    * 实现Systemui 状态栏 声音， WIFI。
- 2016/07/16-2016-/07/31
  * 董鹏
    * 根据最新效果图重置开始菜单页面，及其功能
    * 根据效果图重置开始菜单电源页面，及其展示位置
- 2016/08/01-2016-/08/15
  * 董鹏 卢宁
    * 根据最新效果图重置开始菜单页面，及其功能
    * 根据效果图重置开始菜单电源页面，及其展示位置
- 2016/08/15-2016-/08/21
  * 董鹏 
    * 开始菜单左侧鼠标右键
    * 多窗口阴影调研
  * 卢宁
    * 左侧常用软件列表-限制7个。
    * App应用名称长度限制10个字符.
    * 卸载
  * 曹永韧
    * 固定到任务栏。
  * 王利峰
    * 分类排序，升序降序。
  * 于鹏 
    * 电源。
    * 输入法
- 2016/08/22-2016-/08/26
  * 董鹏 
    * Startmenu-电源 背景黑色太浅 ;home加一个白线
    * 左侧(常用软件)与右侧(app列表)比例不对,需修改
    * wifi 和声音 布局 调整 修改背影
    * 电源
  * 卢宁
    * 多窗口三个图标： 关闭 最大化 隐藏。
    * startmenu点击效果位置偏移
    * 从此列表中移除
    * 输入法
  * 曹永韧
    * 输入法 ，电量 ，wifi， 声音，时间图标替换
    * 以手机模式运行。
    * 以桌面模式运行
  * 王利峰
    * 电源,设置,文件管理器 图标大
    * 分类排序，升序降序。
    * 菜单选项上三角不明显,需重新提供
    * 鼠标滑过及点击效果,图片一天切换
    * 底部任务栏鼠标事件未替换成效果图
    * 周一确认返回按钮,及位置
- 2016/08/27-2016-/08/30
  * 董鹏 
  * bug  修复
    

# 设计与实现

分别叙述整体的模块和技术要点。

##　systemui整体模块叙述
- 请查看：[systemui_module_narrative.md](https://github.com/openthos/systemui-analysis/blob/master/doc/summary/systemui_module_narrative.md)

##　以status bar为入口，查看各个模块所在位置。
- 请查看： [trace function.md](https://github.com/openthos/systemui-analysis/blob/master/doc/summary/trace%20function.md)
 
##　如何进行跨项目间的数据传输
 - 项目中之间数据传输是通过有序广播来实现接受和处理的，请查看 ：
 [systemui_broadcast.md](https://github.com/openthos/systemui-analysis/blob/master/doc/summary/systemui_broadcast.md)

##　如何弹系统级的dialog
- systemui apk 整个宽度为不大于100单位值，如果在这里弹出一个dialog是无法看到的，</br >因为其父布局的高度只有不到100单位值，
如何弹出一个同父布局一个等级的dialog：</br >请查看：
[system_dialog.md](https://github.com/openthos/systemui-analysis/blob/master/doc/summary/system_dialog.md)

